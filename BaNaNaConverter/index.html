<!doctype html>
<html>
	<head>
		<title>BaNaNa Converter</title>
		<link rel="stylesheet" href="../css/style.css">
		<meta charset="UTF-8> 
		<meta name="description" content="Bananas, Calculator, Converter">
		<meta name="keywords" content="Bananas, Sporkinator, Cutlery, Calculator, Converter, Banana"> 
		<meta name="author" content="Muppet">
		<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
		<style>
			#pile-container {
    			position: relative;
    			height: 400px; /* adjust as needed */
   				width: 100%;
				overflow: hidden;
				z-index: 1;
			}
			.converter-form {
				text-align: center;
				padding-top: 20px;
				position: relative;
				z-index: 2;
				background: transparent;
				pointer-events: auto;			
			}
			#banana-zone {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				z-index: 10;
				pointer-events: none;
			}
			.bananas {
   				font-size: 30px; /* makes the emoji big */
    			position: absolute;
    			left: 0;
    			top: 0;
    			filter: drop-shadow(2px 2px 2px rgba(0,0,0,0.3));
				transition: top 1s ease-in;
			}
			.converter-form input[type="number"] {
   				width: 50px;
			}
		</style>
	</head>
	<body>
		<div id="header-placeholder"></div>
		
		<h1>BaNaNa Converter</h1>
		<p class="citation">Scale of banana is based on Sultan, et al. (2018).</p>
		<div id="pile-container">
			<p class="instructions">How many bananas does one need??</p>
			<div class="converter-form">
				<span>For</span><input type="number" id="meters">
				<span>meter, </span>
				<button onclick="calculate_meters()">you'll need</button>
				<span><span id="result"> ... </span> bananas</span>
			</div>	
			<div class="converter-form">
				<span>For</span><input type="number" id="meters2">
				<span>meter<sup>2</sup>, </span>
				<button onclick="calculate_meters2()">you'll need</button>
				<span><span id="result2"> ... </span> bananas</span>
			</div>	
			<div class="converter-form">
				<span>For</span><input type="number" id="meters3">
				<span>meter<sup>3</sup>, </span>
				<button onclick="calculate_meters3()">you'll need</button>
				<span><span id="result3"> ... </span> bananas</span>
			</div>			
			<div class="converter-form">
				<span>For</span><input type="number" id="kg">
				<span>Kg, </span>
				<button onclick="calculate_kg()">you'll need</button>
				<span><span id="result4">...</span> bananas</span>
			</div>
			<div id="banana-zone"></div>
		</div>	
		<div class="rating-slider">
			<div class="slider-container">
				<input type="range" id="rating" min="0" max="33" step="3" value="0">
				<div id="banana-pointer">üçå</div>
		 	</div>
			<p>Rate us on a scale of bananas: <span id="rating-value">3</span>/33</p>
		</div>
		<p class="citation"><small>Sultan, S., Rangaraju, V., Nambi, E., Chandrasekar, V. 2018. Mathematical modeling of physical properties of banana fruit for machine vision systems using image processing method. <em>Journal of Advanced Research in Dynamical and Control Systems,</em> 10: 611-617. </small></p>
		<div id="footer-placeholder"></div>	
		
				<div id="banner-placeholder"></div>
		
		<script>
       // Load header and footer
       		  fetch('../header.html') // adjust path as needed
            	 .then(response => response.text())
           		 .then(data => {
                	document.getElementById('header-placeholder').innerHTML = data;
           		  });

        	fetch('../footer.html')
            	.then(response => response.text())
            	.then(data => {
                	document.getElementById('footer-placeholder').innerHTML = data;
            	});

			fetch('../footer-banner.html')
				.then(response => response.text())
            	.then(data => {
                	document.getElementById('banner-placeholder').innerHTML = data;
            	});
			function calculate_meters() {
				const length = 16.99;
				const meters = parseFloat(document.getElementById('meters').value);
				const m = meters * 100;
				
				let resultSpan = document.getElementById('result');
				resultSpan.classList.remove('error');
				
				if (isNaN(m)) {
					resultSpan.innerText = "Please, enter a valid number";
					resultSpan.classList.add('error');
					return;		
				}
				let b = m / 16.99;
				resultSpan.innerText = b.toFixed(2);
				dropBananas(Math.ceil(b));
			}
			function calculate_meters2() {
				const length = 16.99;
				const width = 3.78;
				const wholebanana = 16.99 * 3.78;
				const meters2 = parseFloat(document.getElementById('meters2').value);
				const m2 = meters2 * 10000;
				
				let	result2Span = document.getElementById('result2');
				result2Span.classList.remove('error');
				
				if (isNaN(m2)) {
					result2Span.innerText = "Please, enter a valid number";
					result2Span.classList.add('error');
					return;		
				}
				let b2 = m2 / wholebanana;
				result2Span.innerText = b2.toFixed(2);
				dropBananas(Math.ceil(b2));
			}
			function calculate_meters3() {
				const volume = 136.33;
				//const v2 = 136.33 / 100
				const meters3 = parseFloat(document.getElementById('meters3').value);
				const m3 = meters3 * 1000000;
				
				let result3Span = document.getElementById('result3');
				result3Span.classList.remove('error');
				
				if (isNaN(m3)) {
					result3Span.innerText = "Please, enter a valid number";
					result3Span.classList.add('error');
					return;		
				}
				let b3 = m3 / 136.33;
				let b3a = b3 / 100
				result3Span.innerText = b3.toFixed(2);
				dropBananas(Math.ceil(b3a));
			}
			function calculate_kg() {
				const mass = 139.65;
				const kg = parseFloat(document.getElementById('kg').value);
				const kgb = kg * 1000;
				
				let	result4Span = document.getElementById('result4');
				result4Span.classList.remove('error');
				
				if (isNaN(kgb)) {
					result4Span.innerText = "Please, enter a valid number";
					result4Span.classList.add('error');
					return;		
				}
				let b4 = kgb / mass;
				result4Span.innerText = b4.toFixed(2);
				dropBananas(Math.ceil(b4));
			}
				function dropBananas(count) {
    			const bananaZone = document.getElementById('banana-zone');			
				bananaZone.innerHTML = ''; // clear previous bananas

				const pile = document.getElementById('pile-container');
				const containerWidth = pile.clientWidth;
				const containerHeight = pile.clientHeight;

    			for (let i = 0; i < count; i++) {
        			const bananas = document.createElement('div');
        			bananas.className = 'bananas';
       				bananas.textContent = 'üçå';

        // Random start x
        			const maxLeft = containerWidth - 30; // adjust for emoji size
        			const startX = Math.random() * Math.max(maxLeft, 0); 
					bananas.style.left = startX + 'px';
					
					// start above container
					const startY = -80 - Math.random() *120;
					bananas.style.top = startY + 'px';

					const maxTop = containerHeight - 40;
					const targetY = maxTop - Math.random() * 10;
				
					const duration = 0.4 + Math.random() * 0.8;
					
					
					//console.log('Bananas ${i}: delay=${delay.toFixed(2)}s');
					bananas.style.transition = 'top ${duration}s ease-in';
					
        			bananaZone.appendChild(bananas);
					
					bananas.offsetHeight;
					const delay = Math.random() * 2 * 1000;

					setTimeout(() => {
						bananas.style.top = targetY + 'px';
						}, delay);				
        // Force a reflow to ensure starting position is applied
        	
				}
			}
		// Rating slider with banana pointer
		const ratingSlider = document.getElementById('rating');
		const bananaPointer = document.getElementById('banana-pointer');
		const ratingSpan = document.getElementById('rating-value');

		function updateBananaPosition() {
    		const percent = (ratingSlider.value - ratingSlider.min) / (ratingSlider.max - ratingSlider.min);
    		const sliderWidth = ratingSlider.offsetWidth;
   			const bananaWidth = 30; // approximate
   		 	const newLeft = percent * (sliderWidth - bananaWidth);
   			bananaPointer.style.left = newLeft + 'px';
   			ratingSpan.textContent = ratingSlider.value;
		}

// Load saved rating
		const savedRating = localStorage.getItem('calculatorRating');
		if (savedRating) {
    		ratingSlider.value = savedRating;
			updateBananaPosition();
		}

// Update on input
		ratingSlider.addEventListener('input', function() {
    		updateBananaPosition();
    		localStorage.setItem('calculatorRating', this.value);
		});
		document.getElementById('submit-rating').addEventListener('click', function() {
			const rating = ratingSlider.value;
			fetch('https://formspree.io/f/mnjbgdre', {
				  method: 'POST',
				  headers: { 'Content-Type': 'application/json' },
				  body: JSON.stringify({ rating: rating })
			}).then(() => (
				  alert('Thanks for rating!');
			}).catch(err => console.log('Rating send failed:', err));
		});

// Update on window resize
		window.addEventListener('resize', updateBananaPosition);

// Initial update
		updateBananaPosition();

		</script>
	</body>
</html>



















